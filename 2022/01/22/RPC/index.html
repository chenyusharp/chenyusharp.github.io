<!DOCTYPE html>
<html>
  <!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  
  <title>RPC - 技术、生活、思考</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  
  <meta name="keywords" content=rpc>
  
  
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.02">
  
  
    <link rel="alternate" href="/atom.xml " title="技术、生活、思考" type="application/atom+xml">
  

  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>
  <body>
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">技术、生活、思考</a>
    <div class="subtitle"></div>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">Home</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">Archives</a>
        </li>
      
        <li class="menu-item">
          <a href="/about" class="menu-item-link">About</a>
        </li>
      
        <li class="menu-item">
          <a href="/categories" class="menu-item-link">Categories</a>
        </li>
      
        <li class="menu-item">
          <a href="/tags" class="menu-item-link">Tags</a>
        </li>
      
    </ul>
  </nav>
</header>
<article class="post">
  <div class="post-title">
    <h1 class="article-title">RPC</h1>
  </div>
   <div class="post-meta">
    <span class="post-time">2022-01-22</span>
  </div>
  <div class="post-content">
    <p>[TOC]</p>
<h3 id="了解rpc吗？"><a href="#了解rpc吗？" class="headerlink" title="了解rpc吗？"></a>了解rpc吗？</h3><p>RPC远程过程调用，借助RPC可以做到像本地调用一样调用远程服务，是一种进程间的通讯方式。</p>
<p>RPC的架构（组成部分）：</p>
<ul>
<li>客户端（client），服务的调用方；</li>
<li>客户端存根（stub），存放服务端地址消息，再将客户端的请求参数打包成网络消息，然后通过网络远程调用发送给服务方；</li>
<li>服务端（server）：真正的服务提供者；</li>
<li>服务端存根（server stub）：解析客户端发送过来的数据包，调用本地方法；有哪些常见的rpc框架？</li>
</ul>
<h3 id="如何自己设计一个rpc框架？"><a href="#如何自己设计一个rpc框架？" class="headerlink" title="如何自己设计一个rpc框架？"></a>如何自己设计一个rpc框架？</h3><ol>
<li>服务注册与发现：注册中心只需要能存储服务信息即可，并且一定要保证高可用性；不要服务中心挂掉了，所有的服务都用不了了。<br>常用的软件：</li>
</ol>
<ul>
<li>zookeeper</li>
<li>Etcd</li>
<li>Consul</li>
<li>Nacos（阿里的Nacos可以实现动态服务配置、服务发现、服务元数据以及流量管理等）</li>
</ul>
<ol start="2">
<li>服务入口<br>在Java中，远程调用，我们不可能把每个服务接口都暴露在外面，而是一个入口接受参数，再由这个入口分发到系统内部的某个服务，调用后返回结果。</li>
<li>序列化<ul>
<li>grpc</li>
<li>hession</li>
<li>java自带的序列化</li>
<li>json/xml</li>
</ul>
</li>
<li>负载均衡算法<ul>
<li>轮训</li>
<li>随机</li>
<li>权重</li>
<li>最少连接</li>
<li>ip_hash</li>
</ul>
</li>
</ol>
<h3 id="Dubbo了解吗？"><a href="#Dubbo了解吗？" class="headerlink" title="Dubbo了解吗？"></a>Dubbo了解吗？</h3><h3 id="Dubbo-提供了哪些负载均衡策略？"><a href="#Dubbo-提供了哪些负载均衡策略？" class="headerlink" title="Dubbo 提供了哪些负载均衡策略？"></a>Dubbo 提供了哪些负载均衡策略？</h3><ol>
<li>基于hash一致性的ConsistentHashLoadBalance；</li>
<li>基于权重随机算法的RandomLoadBalance；</li>
<li>基于最少活跃调用算法的LeastActiveLoadBalance;</li>
<li>基于加权轮询算法的RoundRobinLoadBalance；</li>
<li>基于最短响应时间的ShortestResponseLoadBalance;</li>
</ol>
<h3 id="如何设计一个网关"><a href="#如何设计一个网关" class="headerlink" title="如何设计一个网关"></a>如何设计一个网关</h3><h4 id="核心设计："><a href="#核心设计：" class="headerlink" title="核心设计："></a>核心设计：</h4><ul>
<li>请求路由</li>
<li>服务注册</li>
<li>负责均衡</li>
<li>弹力设计： 增加异步、重试、幂等、流控、降级、熔断、监视等功能；</li>
<li>安全方面：权限控制、数据校验、SSL加密及证书管理</li>
<li>灰度发布：测试版本在某些服务器上进行发布；</li>
<li>API聚合/API编排</li>
</ul>
<h4 id="重点："><a href="#重点：" class="headerlink" title="重点："></a>重点：</h4><ul>
<li>高性能：使用异步非阻塞的通信框架Netty；</li>
<li>高可用：集群化设计，并且不同的节点之间需要同步数据；</li>
<li>服务化：提供一个Admin  API来在运行时修改自己的配置；</li>
<li>高扩展性：网关或多或少会有一些业务逻辑，而业务是多变的，因此网关需要有扩展性；</li>
</ul>
<h4 id="运维方面："><a href="#运维方面：" class="headerlink" title="运维方面："></a>运维方面：</h4><ul>
<li>业务送耦合、协议紧耦合；</li>
<li>应用监控，提供分析数据；分布式链路追踪</li>
<li>DevOps；</li>
</ul>
<h4 id="架构："><a href="#架构：" class="headerlink" title="架构："></a>架构：</h4><ul>
<li>不要在网关中内置聚合后端服务的功能，采用plugin的方式；</li>
<li>网关应该靠近后端服务，并合后端服务使用同一个内网，这样可以保证通信的低延迟；</li>
<li>要支持容量扩展，所以需要成为一个集群来分担前端带来的流量；</li>
<li>服务发现可以有缓存；</li>
<li>校验用户请求：用户是否已经登陆，token验证；</li>
<li>监控，比如说检测异常访问；</li>
</ul>
<h3 id="谈谈对微服务的认识？"><a href="#谈谈对微服务的认识？" class="headerlink" title="谈谈对微服务的认识？"></a>谈谈对微服务的认识？</h3><h3 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h3><p>http/http2</p>

  </div>
  <div class="post-footer">
    
      <ul class="post-tag-list" itemprop="keywords"><li class="post-tag-list-item"><a class="post-tag-list-link" href="/tags/rpc/" rel="tag">rpc</a></li></ul>
    

    <a href="#top" class="top">Back to Top</a>
  </div>
</article>
<footer>
  &copy; 2022
  <span class="author">
    chenyusharp
  </span>
</footer>
    </div>
  </body>
</html>